<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Excel OCR Demo</title>
</head>
<body style="font-family: sans-serif; padding: 40px;">

<h2>이미지 업로드 후 Excel 형식 변환</h2>

<input type="file" id="imageInput" accept="image/*" />
<br><br>
<button onclick="uploadImage()">변환하기</button>

<pre id="result" style="margin-top:30px; background:#f4f4f4; padding:20px;"></pre>

<script>
async function uploadImage() {
  const file = document.getElementById("imageInput").files[0];
  if (!file) {
    alert("이미지를 선택하세요.");
    return;
  }

  const reader = new FileReader();
  reader.onload = async function() {
    const base64Image = reader.result;

    const response = await fetch("/api/ocr", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ image: base64Image })
    });

    const data = await response.json();
    document.getElementById("result").textContent = data.result;
  };
  reader.readAsDataURL(file);
}
</script>

</body>
</html>
